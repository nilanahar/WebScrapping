''' Extracting & Visulization of data gathered from different html links'''

# install all packages

!pip install yfinance
#!pip install pandas
#!pip install requests
!pip install bs4
#!pip install plotly

import yfinance as yf
import pandas as pd
import requests
from bs4 import BeautifulSoup
import plotly.graph_objects as go
from plotly.subplots import make_subplots

### TESLA ### 

## Use YF to Extract Data ##

# use the Ticker function, extract data on to create a ticker object
tesla=yf.Ticker('TSLA')

# extract stock information
tesla_data=tesla.history(period="max")

# reset the index
tesla_data.reset_index(inplace=True)

# print first 5 rows
tesla_data.head()

## Use Webscraping to Extract Data ##

# save url
tesla_url='https://www.macrotrends.net/stocks/charts/TSLA/tesla/revenue'

# use requests to get url information
html_data_tesla=requests.get(tesla_url).text

# use BeautifulSoup object 
tesla_soup=BeautifulSoup(html_data_tesla,'html5lib')

# create a data fame 
tesla_revenue = pd.DataFrame(columns=["Date", "Revenue"])

# extract data from html and append to panda data frame
for row in tesla_soup.find("tbody").find_all("tr"):
    col = row.find_all("td")
    date =col[0].text
    revenue = col[1].text
    
    tesla_revenue = tesla_revenue.append({"Date":date, "Revenue":revenue},ignore_index=True)

# remove all dollar signs and commas
tesla_revenue['Revenue']=tesla_revenue['Revenue'].str.replace(',|\$',"")

# print last 5 rows
tesla_revenue.tail()





### GAME STOP ### 

## Use yfinance to Extract Data ##

# use the Ticker function, extract data on to create a ticker object
gme=yf.Ticker('GME')

# extract stock information
gme_data=gme.history(period="max")

# reset the index
gme_data.reset_index(inplace=True)

# print first 5 rows
gme_data.head()

## Use Webscraping to Extract Data ##

# save url
url_gme='https://www.macrotrends.net/stocks/charts/TSLA/tesla/revenue'

# use requests to get url information
html_data_gme=requests.get(url_gme).text

# use BeautifulSoup object 
gme_soup=BeautifulSoup(html_data_gme,'html5lib')

# create a data fame 
gme_revenue = pd.DataFrame(columns=["Date", "Revenue"])

# extract data from html and append to panda data frame
for row in gme_soup.find("tbody").find_all("tr"):
    col = row.find_all("td")
    date =col[0].text
    revenue = col[1].text
    
    gme_revenue = gme_revenue.append({"Date":date, "Revenue":revenue},ignore_index=True)

# remove all dollar signs and commas
gme_revenue['Revenue']=gme_revenue['Revenue'].str.replace(',|\$',"")

# print last 5 rows
gme_revenue.tail()



